---
interface Props {
  headline: string;
  subheadline?: string;
  subBodyText?: string;
  ctaLabel?: string;
  ctaUrl?: string;
  images?: string[];
}

const {
  headline,
  subheadline = '',
  subBodyText = '',
  ctaLabel,
  ctaUrl = '',
} = Astro.props as Props;

const locale = Astro.currentLocale ?? 'de';
const localizedCtaLabel = ctaLabel || (locale.startsWith('de') ? 'Kurse Buchen' : 'Book Classes');
const showCta = Boolean(ctaUrl);

  const gridImages = [
    { src: '/assets/tiled_bw_yoga_closeup_1.png',        alt: locale.startsWith('de') ? 'Yoga Nahaufnahme' : 'Yoga closeup' },
    { src: '/assets/tiled_bw_red_light_therapy1.jpeg',   alt: locale.startsWith('de') ? 'Rotlichttherapie' : 'Red light therapy' },
    { src: '/assets/tiled_bw_theme_calisthenics.png',    alt: locale.startsWith('de') ? 'Kalisthenics' : 'Calisthenics' },
    { src: '/assets/tiled_bw_red_light_therapy2.jpeg',   alt: locale.startsWith('de') ? 'Rotlichttherapie' : 'Red light therapy' },
  ];

---

<section class="w-full bg-eos-base py-16 lg:py-24">
  <div class="mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="grid w-full gap-12 lg:grid-cols-2 lg:gap-16 lg:items-center">

      <!-- Left column: Text + CTA -->
      <div class="flex flex-col items-center gap-y-6 text-center md:items-start md:text-left">
        <h1 class="font-serif text-4xl font-black uppercase leading-tight text-eos-accent md:text-5xl lg:text-6xl">
          {headline}
        </h1>

        {subheadline && (
          <h2 class="font-serif text-2xl font-semibold uppercase leading-snug text-eos-accent md:text-3xl">
            {subheadline}
          </h2>
        )}

        {subBodyText && (
          <p class="max-w-lg text-xl leading-relaxed text-eos-text/80 md:text-2xl">
            {subBodyText}
          </p>
        )}

        {showCta && (
          <a
            href={ctaUrl}
            class="mt-2 inline-flex items-center justify-center rounded-full bg-eos-accent px-8 py-4 text-base font-bold uppercase tracking-wide text-white transition-all duration-300 hover:bg-eos-accent/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-eos-accent"
          >
            {localizedCtaLabel}
          </a>
        )}
      </div>

      <!-- Right column: 2Ã—2 image grid -->
      <div
        id="hero-grid"
        class="grid grid-cols-2 gap-3 sm:gap-4"
        aria-hidden="true"
      >
        {gridImages.map((img, i) => (
          <div
            class={`hero-grid-item delay-${i} aspect-square overflow-hidden rounded-2xl`}
          >
            <img
              src={img.src}
              alt={img.alt}
              class="h-full w-full object-cover img-greyscale"
              loading={(i === 0 || i === 1) ? 'eager' : 'lazy'}
              decoding="async"
            />
          </div>
        ))}
      </div>

    </div>
  </div>
</section>

<style>
  .hero-grid-item {
    opacity: 0;
    transform: translateY(16px);
    animation: heroFadeUp 0.7s ease forwards;
  }

  .hero-grid-item.delay-0 { animation-delay: 0.05s; }
  .hero-grid-item.delay-1 { animation-delay: 0.18s; }
  .hero-grid-item.delay-2 { animation-delay: 0.31s; }
  .hero-grid-item.delay-3 { animation-delay: 0.44s; }

  @keyframes heroFadeUp {
    from {
      opacity: 0;
      transform: translateY(16px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .hero-grid-item {
      animation: none;
      opacity: 1;
      transform: none;
    }
  }
</style>

<script>
  (function () {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    const grid = document.getElementById('hero-grid');
    if (!grid) return;

    const handleScroll = () => {
      const scrolled = window.scrollY;
      const rect = grid.getBoundingClientRect();
      const viewH = window.innerHeight;

      if (rect.top < viewH && rect.bottom > 0) {
        const progress = Math.max(0, (viewH - rect.top) / (viewH + rect.height));
        const offset = (progress - 0.5) * -24;
        grid.style.transform = `translateY(${offset}px)`;
      }
    };

    window.addEventListener('scroll', handleScroll, { passive: true });
    handleScroll();
    document.addEventListener('astro:after-swap', handleScroll);
  })();
</script>
